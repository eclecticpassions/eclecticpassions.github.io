<!doctype html><html lang=en-GB data-theme><head><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><meta name=theme-name content="Anubis2"><title>Using GitHub Actions to Automate Hugo Static Site Deployment to GitHub Pages - Burgeon Lab</title>
<meta name=description content="ADD META DESCRIPTION FOR PAGE WITHIN 160 CHAR"><link rel=icon type=image/x-icon href=https://www.burgeonlab.com/favicon.ico><link rel=apple-touch-icon-precomposed href=https://www.burgeonlab.com/favicon.png><link rel=stylesheet href=/css/style.min.44f8240afd8df81b52565c4119ac5ae247776c77fc6d7ccf6e101a6c98abfa7a.css integrity="sha256-RPgkCv2N+BtSVlxBGaxa4kd3bHf8bXzPbhAabJir+no="><link rel=stylesheet href=/css/style.min.c4c04b3ef88e3d619ad4c7ee5e03048422bc55c4fefdc1f07657c1133670aa22.css integrity="sha256-xMBLPviOPWGa1MfuXgMEhCK8VcT+/cHwdlfBEzZwqiI="><link rel=stylesheet href=/css/style.min.21c5d8fe0a79d623b0adc1ce4bd4f6dd2c05cd939c9aaaa966ba7186b1464f4d.css integrity="sha256-IcXY/gp51iOwrcHOS9T23SwFzZOcmqqpZrpxhrFGT00="><link rel=stylesheet href=/css/style.min.af811004bb7220558f9185294b1799724c01606d6cb376eec83ea67a6ac245ac.css integrity="sha256-r4EQBLtyIFWPkYUpSxeZckwBYG1ss3buyD6memrCRaw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4 crossorigin=anonymous></script><script src=/js/script.min.08f04d96386c73c9bf4d160333f8f448c05a6e01c06770542ee0e013954ce930.js type=text/javascript integrity="sha256-CPBNljhsc8m/TRYDM/j0SMBabgHAZ3BULuDgE5VM6TA="></script><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css rel=stylesheet><meta name=seobility content="d95cb7b8ecb043254606cfad6f1d7932"></head><body><a class=skip-main href=#main>Skip to main content</a><div class=container><header class=common-header id=top-anchor><div class=header-top><div class=header-top-left><div class=header-content><img class=site-logo src=/apple-touch-icon.png><div class=left-content><h1 class="site-title noselect"><a href=/>Burgeon Lab</a></h1><p class=site-description>A tech enthusiast's logbookâ€”from building a starter home lab to other digital enlightenments.</p><div class=social-links><ul class="social-icons noselect"><li><a href=https://fosstodon.org/@eclecticpassions title=Mastodon rel=me><span class=inline-svg><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-mastodon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg></span></a></li><li><a href=https://github.com/eclecticpassions title=Github rel=me><span class=inline-svg><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-github"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></span></a></li><li><a href=https://www.aperture2iris.com title="Photo blog" rel=me><span class=inline-svg><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M220.6 121.2 271.1 96H448v96H333.2c-21.9-15.1-48.5-24-77.2-24s-55.2 8.9-77.2 24H64v-64h128c9.9.0 19.7-2.3 28.6-6.8zM0 128V416c0 35.3 28.7 64 64 64h384c35.3.0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H271.1c-9.9.0-19.7 2.3-28.6 6.8L192 64h-32V48c0-8.8-7.2-16-16-16H80c-8.8.0-16 7.2-16 16v16C28.7 64 0 92.7.0 128zM168 304a88 88 0 11176 0 88 88 0 11-176 0z"/></svg></span></a></li><li><a href=https://www.eclecticpassions.net title="General blog" rel=me><span class=inline-svg><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M61.7 169.4l101.5 278C92.2 413 43.3 340.2 43.3 256c0-30.9 6.6-60.1 18.4-86.6zm337.9 75.9c0-26.3-9.4-44.5-17.5-58.7-10.8-17.5-20.9-32.4-20.9-49.9.0-19.6 14.8-37.8 35.7-37.8.9.0 1.8.1 2.8.2-37.9-34.7-88.3-55.9-143.7-55.9-74.3.0-139.7 38.1-177.8 95.9 5 .2 9.7.3 13.7.3 22.2.0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5.0.0-11.5 1.3-24.3 2l77.5 230.4L249.8 247l-33.1-90.8c-11.5-.7-22.3-2-22.3-2-11.5-.7-10.1-18.2 1.3-17.5.0.0 35.1 2.7 56 2.7 22.2.0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5.0.0-11.5 1.3-24.3 2l76.9 228.7 21.2-70.9c9-29.4 16-50.5 16-68.7zm-139.9 29.3-63.8 185.5c19.1 5.6 39.2 8.7 60.1 8.7 24.8.0 48.5-4.3 70.6-12.1-.6-.9-1.1-1.9-1.5-2.9l-65.4-179.2zm183-120.7c.9 6.8 1.4 14 1.4 21.9.0 21.6-4 45.8-16.2 76.2l-65 187.9C426.2 403 468.7 334.5 468.7 256c0-37-9.4-71.8-26-102.1zM504 256c0 136.8-111.3 248-248 248C119.2 504 8 392.7 8 256 8 119.2 119.2 8 256 8c136.7.0 248 111.2 248 248zm-11.4.0c0-130.5-106.2-236.6-236.6-236.6C125.5 19.4 19.4 125.5 19.4 256S125.6 492.6 256 492.6c130.5.0 236.6-106.1 236.6-236.6z"/></svg></span></a></li><li><a href=/index.xml title=RSS rel=me><span class=inline-svg><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></span></a></li></ul></div></div></div></div><div class=header-top-right></div></div><nav class=noselect><a href=https://www.burgeonlab.com/ title>Home</a>
<a href=https://www.burgeonlab.com/about/ title>About</a>
<a href=https://www.burgeonlab.com/posts/ title>Posts</a>
<a href=https://www.burgeonlab.com/tags/ title>Tags</a>
<a href=https://www.burgeonlab.com/series/ title>Series</a></nav></header><main id=main tabindex=-1><article class="post h-entry"><div class=post-header><header><h1 class="p-name post-title">Using GitHub Actions to Automate Hugo Static Site Deployment to GitHub Pages</h1></header><div class="post-info noselect"><div class="post-date dt-published"><time datetime=2025-04-22>2025-04-22</time></div><a class="post-hidden-url u-url" href=/2025/using-github-actions-to-automate-hugo-static-site-deployment-to-github-pages/>/2025/using-github-actions-to-automate-hugo-static-site-deployment-to-github-pages/</a>
<a href=https://www.burgeonlab.com/ class="p-name p-author post-hidden-author h-card" rel=me></a><div class=post-taxonomies><ul class=post-tags><li><a href=/tags/hugo>#hugo</a></li><li><a href=/tags/git>#git</a></li><li><a href=/tags/github>#github</a></li></ul></div></div></div><details class="toc noselect"><summary>Table of Contents</summary><div class=inner><nav id=TableOfContents><ul><li><a href=#preface>Preface</a><ul><li><a href=#prerequisites>Prerequisites</a></li></ul></li><li><a href=#github-action-workflow>GitHub Action Workflow</a><ul><li><a href=#basic-trigger>Basic Trigger</a></li><li><a href=#advanced-trigger>Advanced Trigger</a></li></ul></li></ul></nav></div></details><script>var toc=document.querySelector(".toc");toc&&toc.addEventListener("click",function(){event.target.tagName!=="A"&&(event.preventDefault(),this.open?(this.open=!1,this.classList.remove("expanded")):(this.open=!0,this.classList.add("expanded")))})</script><div class="content e-content"><h2 id=preface><div><a href=#preface>#
</a>Preface</div></h2><p>Occasionally, I need to work on different devices without access to my main computer at home. Being able to pull my Hugo blog &ldquo;source&rdquo;, i.e. not the published website files (html, css, etc), onto a remote device, be it another computer or phone, and work on that without interruption is convenient.</p><p>I will show you how I use GitHub to create a source repository (repo) and using a GitHub Action to auto trigger a workflow (only triggering when the draft status changes) that will publish and deploy the site onto the free hosting GitHub Pages offers to all users.</p><h3 id=prerequisites><div><a href=#prerequisites>##
</a>Prerequisites</div></h3><p>I&rsquo;m assuming you already have your <a href=https://gohugo.io/getting-started/quick-start/>Hugo</a> site locally set up. Create a new account on GitHub if you haven&rsquo;t done so already. Make a new repo for all the files Hugo uses to build the site. Add a <code>.gitignore</code> file to the root folder with the following to prevent the site files to be synced with this source repo.</p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>/public/
</span></span><span style=display:flex><span>/resources/
</span></span><span style=display:flex><span>.DS_Store
</span></span></code></pre></div><p>You can now write wherever you are just by pulling this repo and making changes. Push to the repo to &ldquo;save&rdquo; your progress and resume on any device by repeating this process.</p><h2 id=github-action-workflow><div><a href=#github-action-workflow>#
</a>GitHub Action Workflow</div></h2><p>Using the free hosting of a site offered on <a href=https://pages.github.com/>GitHub Pages</a>, we will automate building of the site (Hugo in our case) and deploy it to the GitHub Pages repo using our source repo with a GitHub Action workflow. First, create a new GitHub Pages repo with a repo name in this format: <code>username.github.io</code>. E.g. mine would be <code>eclecticpassions.github.io</code> as eclecticpassions is my GitHub username.</p><h3 id=basic-trigger><div><a href=#basic-trigger>##
</a>Basic Trigger</div></h3><p>If you want the Action to run and build the site every time your source repo is updated, you can use this basic workflow<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>: <code>.github/workflows/pages.yml</code></p><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>hugo publish<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888></span><span style=color:#fb660a;font-weight:700>on</span>:<span style=color:#888> </span><span style=color:#080;background-color:#0f140f;font-style:italic># Runs on pushes targeting the default branch (i.e. master, in my case)</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>  </span><span style=color:#fb660a;font-weight:700>push</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span><span style=color:#fb660a;font-weight:700>branches</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- master<span style=color:#888> </span><span style=color:#080;background-color:#0f140f;font-style:italic># Set the branch name to trigger deployment</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888></span><span style=color:#fb660a;font-weight:700>jobs</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>  </span><span style=color:#fb660a;font-weight:700>build-deploy</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span><span style=color:#fb660a;font-weight:700>runs-on</span>:<span style=color:#888> </span>ubuntu-latest<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span><span style=color:#fb660a;font-weight:700>steps</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Git checkout<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>uses</span>:<span style=color:#888> </span>actions/checkout@v4 <span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>with</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>          </span><span style=color:#fb660a;font-weight:700>submodules</span>:<span style=color:#888> </span><span style=color:#fb660a;font-weight:700>true</span><span style=color:#888>  </span><span style=color:#080;background-color:#0f140f;font-style:italic># Fetch Hugo themes (&#39;true&#39; OR &#39;recursive&#39;). Without this, the site wouldn&#39;t build properly, missing index.html etc.</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>          </span><span style=color:#fb660a;font-weight:700>fetch-depth</span>:<span style=color:#888> </span><span style=color:#0086f7;font-weight:700>2</span><span style=color:#888>    </span><span style=color:#080;background-color:#0f140f;font-style:italic>#  0=Fetch entire commit history. 2=Fetch only the latest 2 commits. </span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Setup Hugo<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>uses</span>:<span style=color:#888> </span>peaceiris/actions-hugo@v3<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>with</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>hugo-version</span>:<span style=color:#888> </span><span style=color:#0086d2>&#39;latest&#39;</span><span style=color:#888> </span><span style=color:#080;background-color:#0f140f;font-style:italic># Update to the latest Hugo version e.g.&#39;0.145.0&#39; or  use  &#39;latest&#39;</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>extended</span>:<span style=color:#888> </span><span style=color:#fb660a;font-weight:700>true</span><span style=color:#888> </span><span style=color:#080;background-color:#0f140f;font-style:italic># Required for CSS to run</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Build<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>run</span>:<span style=color:#888> </span>hugo --minify<span style=color:#888> </span><span style=color:#080;background-color:#0f140f;font-style:italic>#--enableGitInfo  Uncomment enableGitInfo to show last modified date on posts.</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Deploy<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>uses</span>:<span style=color:#888> </span>peaceiris/actions-gh-pages@v3<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>with</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>personal_token</span>:<span style=color:#888> </span>${{ secrets.ACTIONS_DEPLOY_KEY }}<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>external_repository</span>:<span style=color:#888> </span>username/username.github.io<span style=color:#888> </span><span style=color:#080;background-color:#0f140f;font-style:italic>#Enter your GitHub Pages repo name</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>publish_branch</span>:<span style=color:#888> </span>master<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>publish_dir</span>:<span style=color:#888> </span>./public<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>user_name</span>:<span style=color:#888> </span>YourName <span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>user_email</span>:<span style=color:#888> </span>name@domain.com<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>cname</span>:<span style=color:#888> </span>www.your-custom-domain-if-you-have-one.com<span style=color:#888>
</span></span></span></code></pre></div><p>For the <code>personal_token</code> the the last block (Deploy), you need to make a <a href=https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens>personal access token</a>. I used the <em>Fine-grained token</em> which is more secure.</p><img src=/2025/using-github-actions-to-automate-hugo-static-site-deployment-to-github-pages/fine_grained.webp alt="Screenshot of permissions required for fine-grained token to work."><p>Now, add it to your GitHub Pages repo > Settings > Secrets and variables > Actions > New repository secret. Name it <code>ACTIONS_DEPLOY_KEY</code> and paste in the token generated in the previous step.</p><img src=/2025/using-github-actions-to-automate-hugo-static-site-deployment-to-github-pages/actions_deploy_key.webp alt="Screenshot of Github Actions secrets and variables."><h3 id=advanced-trigger><div><a href=#advanced-trigger>##
</a>Advanced Trigger</div></h3><p>If you want it to only build when there is a draft change from true to false (i.e. draft to published), use this workflow<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> below.</p><p><strong>Things of note:</strong></p><ul><li><code>draft_check</code> checks if the draft status in the post <a href=https://gohugo.io/content-management/front-matter/>front matter</a> has changed from the previous commit. (I&rsquo;m using +++, i.e. toml front matter. If you&rsquo;re using &mdash;, yaml, please change the code accordingly.)</li><li><code>if: steps.draft_check.outputs.draft_changed == 'true'</code> condition added to the build and deploy steps so they only run when draft_check is true.</li><li>You should run the basic trigger first so there&rsquo;s a baseline in the repo. Changes to other files, e.g. theme changes, css, layouts will not be pushed until there is a draft status change thereafter if you use the Advanced Trigger. You can comment out paths, draft_check and if conditions to trigger the build and deploy steps.</li></ul><div class=highlight><pre tabindex=0 style=color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>hugo publish<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888></span><span style=color:#fb660a;font-weight:700>on</span>:<span style=color:#888> 
</span></span></span><span style=display:flex><span><span style=color:#888>  </span><span style=color:#fb660a;font-weight:700>push</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span><span style=color:#fb660a;font-weight:700>branches</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- master <span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span><span style=color:#fb660a;font-weight:700>paths</span>:<span style=color:#888> 
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#0086d2>&#39;content/posts/**&#39;</span><span style=color:#888> </span><span style=color:#080;background-color:#0f140f;font-style:italic># Matches any file or folder recursively inside content/posts/, including all subfolders and files like index.md.</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888></span><span style=color:#fb660a;font-weight:700>jobs</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>  </span><span style=color:#fb660a;font-weight:700>build-deploy</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span><span style=color:#fb660a;font-weight:700>runs-on</span>:<span style=color:#888> </span>ubuntu-latest<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span><span style=color:#fb660a;font-weight:700>steps</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Git checkout<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>uses</span>:<span style=color:#888> </span>actions/checkout@v4<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>with</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>          </span><span style=color:#fb660a;font-weight:700>submodules</span>:<span style=color:#888> </span><span style=color:#fb660a;font-weight:700>true</span><span style=color:#888> 
</span></span></span><span style=display:flex><span><span style=color:#888>          </span><span style=color:#fb660a;font-weight:700>fetch-depth</span>:<span style=color:#888> </span><span style=color:#0086f7;font-weight:700>2</span><span style=color:#888>    </span><span style=color:#080;background-color:#0f140f;font-style:italic># 2=Fetch only the latest 2 commits, needed to compare if draft status has changed in front-matter of previous commit.</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Check if draft status changed from true to false <span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>id</span>:<span style=color:#888> </span>draft_check<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>run</span>:<span style=color:#888> </span>|<span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        # Get list of changed files between previous and current commit
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        CHANGED_FILES=$(git diff --name-only ${{ github.event.before }} ${{ github.sha }})
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        echo &#34;Changed files:&#34;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        echo &#34;$CHANGED_FILES&#34;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        draft_changed=false
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        get_draft_status() {
</span></span></span><span style=display:flex><span><span style=color:#0086d2>          local content=&#34;$1&#34;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>          echo &#34;$content&#34; | sed -n &#39;/^+++$/,/^+++$/p&#39; | grep &#39;^draft&#39; | head -1 | awk -F&#39;=&#39; &#39;{print $2}&#39; | tr -d &#39; &#34;&#39;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        }
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        for file in $CHANGED_FILES; do
</span></span></span><span style=display:flex><span><span style=color:#0086d2>          # Only check markdown files under content/posts/
</span></span></span><span style=display:flex><span><span style=color:#0086d2>          case &#34;$file&#34; in
</span></span></span><span style=display:flex><span><span style=color:#0086d2>            content/posts/**/*.md|content/posts/**/index.md)
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              echo &#34;Checking draft status in $file&#34;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              # Get previous draft value (if file existed before)
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              PREV_CONTENT=$(git show ${{ github.event.before }}:$file 2&gt;/dev/null || echo &#34;&#34;)
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              CURRENT_CONTENT=$(cat &#34;$file&#34;)
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              PREV_DRAFT=$(get_draft_status &#34;$PREV_CONTENT&#34; || echo &#34;none&#34;)
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              CURRENT_DRAFT=$(get_draft_status &#34;$CURRENT_CONTENT&#34; || echo &#34;none&#34;)
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              echo &#34;Previous draft: $PREV_DRAFT&#34;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              echo &#34;Current draft: $CURRENT_DRAFT&#34;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              if [[ &#34;$PREV_DRAFT&#34; == &#34;true&#34; &amp;&amp; &#34;$CURRENT_DRAFT&#34; == &#34;false&#34; ]]; then
</span></span></span><span style=display:flex><span><span style=color:#0086d2>                draft_changed=true
</span></span></span><span style=display:flex><span><span style=color:#0086d2>                break
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              fi
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              ;;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>            *)
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              # skip other files
</span></span></span><span style=display:flex><span><span style=color:#0086d2>              ;;
</span></span></span><span style=display:flex><span><span style=color:#0086d2>          esac
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        done
</span></span></span><span style=display:flex><span><span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>        echo &#34;draft_changed=$draft_changed&#34; &gt;&gt; $GITHUB_OUTPUT</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Build and Deploy only if draft changed to false<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>if</span>:<span style=color:#888> </span>steps.draft_check.outputs.draft_changed == &#39;true&#39;<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>run</span>:<span style=color:#888> </span>|<span style=color:#0086d2>
</span></span></span><span style=display:flex><span><span style=color:#0086d2>          # Your build commands here
</span></span></span><span style=display:flex><span><span style=color:#0086d2>          echo &#34;Draft status changed! Proceed to build &amp; deploy...&#34;</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Setup Hugo<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>if</span>:<span style=color:#888> </span>steps.draft_check.outputs.draft_changed == &#39;true&#39;<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>uses</span>:<span style=color:#888> </span>peaceiris/actions-hugo@v3<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>with</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>hugo-version</span>:<span style=color:#888> </span><span style=color:#0086d2>&#39;latest&#39;</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>extended</span>:<span style=color:#888> </span><span style=color:#fb660a;font-weight:700>true</span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Build<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>if</span>:<span style=color:#888> </span>steps.draft_check.outputs.draft_changed == &#39;true&#39;<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>run</span>:<span style=color:#888> </span>hugo --minify<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>    </span>- <span style=color:#fb660a;font-weight:700>name</span>:<span style=color:#888> </span>Deploy<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>if</span>:<span style=color:#888> </span>steps.draft_check.outputs.draft_changed == &#39;true&#39;<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>uses</span>:<span style=color:#888> </span>peaceiris/actions-gh-pages@v3<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>      </span><span style=color:#fb660a;font-weight:700>with</span>:<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>personal_token</span>:<span style=color:#888> </span>${{ secrets.ACTIONS_DEPLOY_KEY }}<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>external_repository</span>:<span style=color:#888> </span>username/username.github.io<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>publish_branch</span>:<span style=color:#888> </span>master<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>publish_dir</span>:<span style=color:#888> </span>./public<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>user_name</span>:<span style=color:#888> </span>YourName <span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>user_email</span>:<span style=color:#888> </span>name@domain.com<span style=color:#888>
</span></span></span><span style=display:flex><span><span style=color:#888>        </span><span style=color:#fb660a;font-weight:700>cname</span>:<span style=color:#888> </span>www.your-custom-domain-if-you-have-one.com<span style=color:#888>
</span></span></span></code></pre></div><p>My Git client of choice on Android is <a href=https://github.com/catpuppyapp/PuppyGit>PuppyGit</a> and on iPad is <a href=https://workingcopyapp.com/>Working Copy</a>.</p><p>That&rsquo;s it, happy writing!</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Check if there are newer @versions of actions: <a href=https://github.com/actions/checkout>&lsquo;actions/checkout&rsquo;</a>, <a href=https://github.com/peaceiris/actions-hugo>&lsquo;actions-hugo&rsquo;</a> and <a href=https://github.com/peaceiris/actions-gh-pages>&lsquo;actions-gh-pages&rsquo;</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>My Hugo blog folder structure is: <code>blog_name/content/posts/2025/post_identifier/index.md</code>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><h3 class="read-next-title noselect">Read next</h3><ul class="read-next-posts noselect"><li><a href=/2024/fixing-toc-anchor-links-behind-top-navigation-header-in-hugo/>Fixing TOC Anchor Links Behind Top Navigation Header in Hugo</a></li><li><a href=/2023/adding-a-simple-scroll-to-the-top-button-to-your-hugo-site/>Adding a simple "scroll to the top" button to your Hugo site</a></li><li><a href=/2023/hello-hugo/>Hello, Hugo</a></li></ul><div class="pagination post-pagination"><div class="left pagination-item disabled"></div><div class="right pagination-item"><a href=/2025/hardening-my-new-android-phone/>Hardening my New Android Phone</a></div></div></main><footer class="common-footer noselect"><div class=common-footer-bottom><div style=display:flex;align-items:center;gap:8px>Â© 2023-2025 Naty S, BurgeonLab.com.</div><div style=display:flex;align-items:center;gap:4px><div>Powered by <a target=_blank rel="noopener noreferrer" href=https://gohugo.io/>Hugo</a>, theme <a target=_blank rel="noopener noreferrer" href=https://github.com/Junyi-99/hugo-theme-anubis2>Anubis2</a>.<br></div></div><p class="h-card vcard"><a href=https://www.burgeonlab.com/ class="p-name u-url url fn" rel=me></a></p></footer></div><a href=#top-anchor><button class=top-anchor><i class="fa fa-angle-double-up" aria-hidden=true></i></button></a></body><footer><script data-goatcounter=https://ledge3.goatcounter.com/count async src=//gc.zgo.at/count.js></script></footer></html>